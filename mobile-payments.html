<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile Payments</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f9fb;
            color: #1a1b1d;
            line-height: 1.6;
            padding: 20px;
        }
        h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: #1a1b1d;
            border-bottom: 3px solid #ffb400;
            padding-bottom: 0.5rem;
        }
        .endpoint {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 1px solid #e9ecef;
        }
        .endpoint:hover {
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        .endpoint-header {
            background-color: #1a1b1d;
            color: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }
        .method {
            background-color: #ffb400;
            color: #1a1b1d;
            padding: 0.4rem 1rem;
            border-radius: 8px;
            font-weight: bold;
            font-size: 0.9rem;
        }
        .endpoint-content {
            padding: 1.5rem;
            display: none;
        }
        .endpoint-content.active {
            display: block;
        }
        .url {
            font-family: 'Consolas', monospace;
            background-color: #f1f3f5;
            padding: 0.8rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            border: 1px solid #e0e0e0;
        }
        .description {
            margin-bottom: 1rem;
            background-color: #f9f9f9;
            padding: 1rem;
            border-radius: 8px;
            border-left: 3px solid #ffb400;
        }
        .code-block {
            background-color: #272822;
            color: #f8f8f2;
            padding: 1rem;
            border-radius: 8px;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h2>Mobile Payments</h2>
    <section id="mobile-payments">
        <div class="endpoint" id="auth-token">
            <div class="endpoint-header">
                <span class="method method-post">POST</span>
                <span class="title">Generate Authentication Token</span>
            </div>
            <div class="endpoint-content">
                <div class="url">
                    <span class="url-text">{{baseUrl}}/auth/</span>
                    <button class="copy-btn"><i class="fas fa-copy"></i> Copy</button>
                </div>
                <div class="description">
                    <p>Generate an authentication token for secure access, then use it in the headers for all subsequent API requests.</p>
                    <p>This is generated by passing the <strong>merchantId</strong> and the <strong>password</strong> provided during onboarding.</p>
                    <ul>
                        <li><strong>merchantId (string):</strong> The ID of the merchant initiating the transfer.</li>
                        <li><strong>password (string):</strong> The password shared during onboarding.</li>
                    </ul>
                    <p>The token should be base64 encoded for subsequent requests.</p>
                    <p>The response returns a token with fields such as the expiry date of the token.</p>
                </div>
                <div class="section">
                    <div class="section-title">Request Body</div>
                    <div class="code-block">
                        <pre>{
    "merchantId": "{{username}}",
    "password": "{{password}}"
}</pre>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Response</div>
                    <div class="code-block">
                        <pre>{
    "error": false,
    "message": "Token Success",
    "accessToken": "2af9ac5ceaa370656c73fecdb5c11f81",
    "expires": 1743790669,
    "expiresDate": "04-Apr-2025 18:17:49"
}</pre>
                    </div>
                </div>
            </div>
        </div>

        <div class="endpoint" id="process-payment">
            <div class="endpoint-header">
                <span class="method method-post">POST</span>
                <span class="title">Start Mobile Payment</span>
            </div>
            <div class="endpoint-content">
                <div class="url">
                    <span class="url-text">{{baseUrl}}/process/</span>
                    <button class="copy-btn"><i class="fas fa-copy"></i> Copy</button>
                </div>
                <div class="description">
                    <p>Make a POST request to initiate a mobile payment using the provided bearer token. The request includes details like merchant ID, currency, amount, payer's phone number, external ID, and callback and redirect URLs.</p>
                    <ul>
                        <li><strong>merchantId (string):</strong> The merchant ID associated with the transaction.</li>
                        <li><strong>currency (string):</strong> The currency of the transaction.</li>
                        <li><strong>payerPhone (string):</strong> The phone number where the amount will be deducted from.</li>
                        <li><strong>amount (string):</strong> The amount involved in the transaction.</li>
                        <li><strong>externalId:</strong> A unique identifier for each transaction.</li>
                        <li><strong>callbackUrl (string):</strong> This is a URL from your end that we will call with the result of the payment, whether successful or failed.</li>
                        <li><strong>redirectUrl (string):</strong> This is a URL on your site where the client will be redirected after a successful/failed payment.</li>
                        <li><strong>uniqueExternalId (bool):</strong> These fields work together to help with payment reconciliation and can help prevent duplicate payments when uniqueExternalId is set to true.</li>
                    </ul>
                </div>
                <div class="section">
                    <div class="section-title">Request Body</div>
                    <div class="code-block">
                        <pre>{
    "merchantId": "{{username}}",
    "currency": "KES",
    "amount": "10.00",
    "payerPhone": "254xxxxxxx",
    "externalId": "BJDemo{{$timestamp}}",
    "callbackUrl": "https://callback.com",
    "redirectUrl": "https://callback.com",
    "uniqueExternalId": false
}</pre>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Response</div>
                    <div class="code-block">
                        <pre>{
    "error": false,
    "message": "Success! Follow the mpesa prompt"
}</pre>
                    </div>
                </div>
            </div>
        </div>

        <div class="endpoint" id="get-transactions">
            <div class="endpoint-header">
                <span class="method method-post">POST</span>
                <span class="title">Read Transaction Mobile</span>
            </div>
            <div class="endpoint-content">
                <div class="url">
                    <span class="url-text">{{baseUrl}}/deposit-transactions/</span>
                    <button class="copy-btn"><i class="fas fa-copy"></i> Copy</button>
                </div>
                <div class="description">
                    <p>Retrieves mobile transactions. Include the bearer token, merchant ID, and the maximum number of transactions to retrieve in the request body. Optional fields include transaction status, currency, and secure ID.</p>
                </div>
                <div class="section">
                    <div class="section-title">Request Body</div>
                    <div class="code-block">
                        <pre>{
    "merchantId": "{{username}}",
    "maxLimit": "10"
}</pre>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Response</div>
                    <div class="code-block">
                        <pre>{
    "error": false,
    "message": "success",
    "data": [
        {
            "reff_id": "LnDemo27",
            "currency": "KES",
            "recipient_phone": "112731188",
            "amount": 10,
            "date_created": "2025-03-05T12:22:37.380927-06:00",
            "status": "failed",
            "secure_id": "7ce1e091-f761-419d-b1ad-ee8eb0f6bd10"
        }
    ]
}</pre>
                    </div>
                </div>
            </div>
        </div>

        <div class="endpoint" id="mobile-send">
            <div class="endpoint-header">
                <span class="method method-post">POST</span>
                <span class="title">Send Money Mobile - Mpesa</span>
            </div>
            <div class="endpoint-content">
                <div class="url">
                    <span class="url-text">{{baseUrl}}/mobile-send/</span>
                    <button class="copy-btn"><i class="fas fa-copy"></i> Copy</button>
                </div>
                <div class="description">
                    <p>Transfers money to a mobile number via Mpesa. Include the bearer token, merchant ID, currency, amount, recipient's phone number, external ID, and a callback URL in the request body.</p>
                </div>
                <div class="section">
                    <div class="section-title">Request Body</div>
                    <div class="code-block">
                        <pre>{
  "merchantId": "{{username}}",
  "currency": "KES",
  "amount": 10,
  "recipientPhone": "+254xxxxxxxx",
  "externalId": "BC{{$timestamp}}",
  "callbackUrl": "https://webhook.site/9b00a0cb-f8da-4ef3-9632-f4c0ad8f0f28",
  "uniqueExternalId": false
}</pre>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Response</div>
                    <div class="code-block">
                        <pre>{
    "error": false,
    "message": "Accept the service request successfully.",
    "sid": "067d201b-a025-79c7-8000-b78fb04653a5"
}</pre>
                    </div>
                </div>
            </div>
        </div>

        <div class="endpoint" id="send-transactions">
            <div class="endpoint-header">
                <span class="method method-post">POST</span>
                <span class="title">Read Transaction Mobile Send Money</span>
            </div>
            <div class="endpoint-content">
                <div class="url">
                    <span class="url-text">{{baseUrl}}/mobile-send-transactions/</span>
                    <button class="copy-btn"><i class="fas fa-copy"></i> Copy</button>
                </div>
                <div class="description">
                    <p>Retrieves mobile money send transactions. Include the bearer token and merchant ID in the request body. Optionally, you can specify the transaction status, currency, and secure ID.</p>
                </div>
                <div class="section">
                    <div class="section-title">Request Body</div>
                    <div class="code-block">
                        <pre>{
    "merchantId": "{{username}}",
    "transactionStatus": "COMPLETED",
    "maxLimit": "10"
}</pre>
                    </div>
                </div>
                <div class="section">
                    <div class="section-title">Response</div>
                    <div class="code-block">
                        <pre>{
    "error": false,
    "message": "Success. Max 500 records. Actual 1",
    "data": [
        {
            "transactionStatus": "COMPLETED",
            "transactionReport": "The service request is processed successfully.",
            "currency": "KES",
            "amount": 11,
            "netAmount": "51.0",
            "fees": 40,
            "secureId": "067d20ba-8d65-7cd5-8000-aacd8d2708ec",
            "recipientPhone": "112549611",
            "externalId": "BC1741818754",
            "callbackUrl": "https://webhook.site/9b00a0cb-f8da-4ef3-9632-f4c0ad8f0f28",
            "transactionDate": "12-03-2025 22:33:13",
            "transactionDateTimestamp": 1741818793,
            "SPRef": "TCD0H57SSA"
        }
    ]
}</pre>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script>
        document.querySelectorAll('.endpoint-header').forEach(header => {
            header.addEventListener('click', () => {
                const content = header.nextElementSibling;
                content.classList.toggle('active');
            });
        });
    </script>
</body>
</html>
